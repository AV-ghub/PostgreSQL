#### Пользовательские скрипты
Программа pgbench поддерживает запуск пользовательских сценариев оценки производительности, позволяя заменять стандартный скрипт транзакции скриптом, считываемым из файла (***с параметром -f***). В этом случае «транзакцией» считается одно выполнение данного скрипта.

Файл скрипта содержит одну или несколько команд SQL, разделённых точкой с запятой. Пустые строки и строки, начинающиеся с --, игнорируются.

#### Полезные советы
Никогда не доверяйте тестам, которые выполняются всего несколько секунд. Воспользуйтесь ***параметром -t и -T*** и установите время выполнения не меньше нескольких минут, чтобы избавиться от шума в средних значениях. В некоторых случаях для получения воспроизводимых результатов тестирование должно продолжаться несколько часов. Чтобы понять, были ли получены воспроизводимые значения, имеет смысл запустить тестирование несколько раз.

Для стандартного сценария по типу TPC-B начальный ***коэффициент масштаба (-s) должен быть не меньше числа клиентов***, с каким вы намерены проводить тестирование (-c); в противном случае вы, по большому счёту, будете замерять время конкурентных изменений. Таблица pgbench_branches содержит всего -s строк, а каждая транзакция хочет изменить одну из них, так что если значение -c превышает -s, это несомненно приведёт к тому, что многие транзакции будут блокироваться другими.

Стандартный сценарий тестирования также довольно сильно зависит от того, сколько времени прошло с момента инициализации таблиц: ***накопление неактуальных строк и «мёртвого» пространства в таблицах влияет на результаты***. Чтобы правильно оценить результаты, необходимо учитывать, сколько всего изменений было произведено и когда выполнялась очистка. ***Если же включена автоочистка, это может быть чревато непредсказуемыми изменениями*** оценок производительности.

Иногда, оценивая производительность одного сервера, полезно запускать несколько экземпляров pgbench параллельно, на отдельных клиентских компьютерах.
