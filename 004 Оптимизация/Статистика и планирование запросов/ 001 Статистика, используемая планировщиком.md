[Документация](https://postgrespro.ru/docs/postgresql/13/planner-stats)

## Статистика по одному столбцу
статистика включает общее число записей в каждой таблице и индексе, а также число дисковых блоков, которые они занимают.  
Эта информация содержится в таблице **pg_class**, в столбцах ***reltuples и relpages***. Получить её можно, например так:

```
SELECT relname, relkind, reltuples, relpages
FROM pg_class
WHERE relname LIKE 'tenk1%';

       relname        | relkind | reltuples | relpages
----------------------+---------+-----------+----------
 tenk1                | r       |     10000 |      358
 tenk1_hundred        | i       |     10000 |       30
 tenk1_thous_tenthous | i       |     10000 |       30
 tenk1_unique1        | i       |     10000 |       30
 tenk1_unique2        | i       |     10000 |       30
(5 rows)
```

Здесь мы видим, что tenk1 содержит 10000 строк данных и столько же строк в индексах (что неудивительно), но объём индексов гораздо меньше таблицы.

Большинство запросов возвращают не все строки таблицы, а только немногие из них, ограниченные условиями WHERE.  
Поэтому планировщику нужно оценить избирательность условий WHERE, то есть определить, какой процент строк будет соответствовать каждому условию в предложении WHERE.  
Нужная для этого информация хранится в системном каталоге **pg_statistic**.  
Значения в pg_statistic обновляются командами ANALYZE и VACUUM ANALYZE и никогда не бывают точными, даже сразу после обновления.

Для исследования статистики лучше обращаться не непосредственно к таблице pg_statistic, а к представлению pg_stats, предназначенному для облегчения восприятия этой информации.  
Кроме того, представление **pg_stats** доступно для чтения всем, тогда как pg_statistic — только суперпользователям.  
(Это сделано для того, чтобы непривилегированные пользователи не могли ничего узнать о содержимом таблиц других людей из статистики.  
Представление pg_stats устроено так, что оно показывает строки только для тех таблиц, которые может читать данный пользователь.)
