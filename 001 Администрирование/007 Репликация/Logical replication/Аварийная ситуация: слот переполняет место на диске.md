# –ê–≤–∞—Ä–∏–π–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è: —Å–ª–æ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω—è–µ—Ç –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ
### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ä–æ—á–Ω–æ:
```sql
-- 1. –†–∞–∑–º–µ—Ä pg_wal –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
SELECT pg_size_pretty(pg_total_relation_size('pg_wal')) as wal_dir_size;

-- 2. –¢–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è WAL
SELECT pg_current_wal_lsn();

-- 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –µ—Å—Ç—å –ª–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å
SELECT application_name, state, sync_state 
FROM pg_stat_replication 
WHERE application_name = 'flink_cdc_demo_slot';
```

## üõ†Ô∏è –ß—Ç–æ –¥–µ–ª–∞—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è
–ï—Å–ª–∏ Flink CDC –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å - –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –µ–≥–æ, —á—Ç–æ–±—ã –æ–Ω –Ω–∞—á–∞–ª –ø–æ—Ç—Ä–µ–±–ª—è—Ç—å WAL.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –£–¥–∞–ª–∏—Ç—å —Å–ª–æ—Ç (–µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω)
```sql
-- –°–õ–û–¢ –£–î–ê–õ–ò–¢–°–Ø –ù–ï–ú–ï–î–õ–ï–ù–ù–û –ò –û–°–í–û–ë–û–î–ò–¢ WAL!
SELECT pg_drop_replication_slot('flink_cdc_demo_slot');
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –º–µ—Å—Ç–∞
```sql
-- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π WAL-—Å–µ–≥–º–µ–Ω—Ç
SELECT pg_switch_wal();

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —É–º–µ–Ω—å—à–∏–ª–æ—Å—å –ª–∏ –æ—Ç—Å—Ç–∞–≤–∞–Ω–∏–µ
SELECT pg_size_pretty(
  pg_wal_lsn_diff(pg_current_wal_lsn(), restart_lsn)
) as lag_size 
FROM pg_replication_slots;
```

## üí° –ü–æ—á–µ–º—É —É –≤–∞—Å "–≤—Å–µ–≥–æ" 98 GB —Å–≤–æ–±–æ–¥–Ω–æ, –Ω–æ –æ—Ç—Å—Ç–∞–≤–∞–Ω–∏–µ 22 GB:

PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Ü–∏–∫–ª–∏—á–µ—Å–∫—É—é –∑–∞–ø–∏—Å—å WAL** –∏ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ** —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤, –ù–û:

- **–°–ª–æ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –ë–õ–û–ö–ò–†–£–ï–¢ —É–¥–∞–ª–µ–Ω–∏–µ** WAL, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –µ—â–µ –Ω–µ –ø—Ä–æ—á–∏—Ç–∞–ª
- **–ï—Å–ª–∏ `pg_wal` –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è** - PostgreSQL –û–°–¢–ê–ù–û–í–ò–¢–°–Ø!
- **–°–∏—Å—Ç–µ–º–∞ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å**, –Ω–æ —Ä–µ—Å—É—Ä—Å—ã –Ω–∞ –∏—Å—Ö–æ–¥–µ

## üö® –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:

**–ù–ï–ú–ï–î–õ–ï–ù–ù–û –ø—Ä–∏–º–∏—Ç–µ —Ä–µ—à–µ–Ω–∏–µ:**
1. **–õ–∏–±–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ** —Ä–∞–±–æ—Ç—É Flink CDC –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è
2. **–õ–∏–±–æ —É–¥–∞–ª–∏—Ç–µ —Å–ª–æ—Ç** `flink_cdc_demo_slot`

**–ü—Ä–æ–º–µ–¥–ª–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ–ª–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–µ PostgreSQL!**

–ü–æ—Å–ª–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—Ç—Å—Ç–∞–≤–∞–Ω–∏—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è —Å–∏—Ç—É–∞—Ü–∏–∏.




































